#### trace_process.py

Simulate reconstruction attacks reconstruction errors (at least 1 error), and generate the traces of the flows reconstructed by the adversary. 

|  option | desc  |detail|
| ------------ | ------------ | ------------ |
| i  | input  trace path   | **trace name**: siteNo_instNo <br> (unmonitored site's instNo is 0) <br> **trace format**: time, direction * size, flowID <br> (comma as delimiter)|
|  o | output trace path  | **trace name**: siteNo_instNo <br> **trace format**: time, direction * size <br> (comma as delimiter) |
|  m | simulation method | **0 (default)**: use the subflows generated by RAVEN  <br> **1**: use simulated subflows generated based on a given migration frequency  <br> **2**:  randomly sample a fraction of packets as the  flow |
| et | error type | **0 (default)**: missing  <br> **1**: wrongly-included  <br>**2**:  both errors |
| er | error rate  | a float number in [0, 1] <br> **default**: 0.1 (10%)|
|  f |  migration frequency | a postive int number. If f = -1, perform random migration <br> **default**: 10|
|  d | path of packet distribution database  | the data can be generated via utils/gen_dist.py|
|  rs | random seed  | set the seed for random function. <br> **default**: not set |
|  h | print help  |   --  |

Examples:

Simulate the case that the adversary fails to include a subflow (missing error) in the reconstructed flow with a probability of 20%. Use simulated subflows and the migration frequency is 20 outgoing packets. The traces produced represent the reconstructed flows. 

```
python trace_process.py -i traces -o trace_out  -m 1 -et 0 -er 0.2 -f 20
```
Simulate the case that the adversary include a wrong subflow (wrongly-included error) in the reconstructed flow with a probability of 10%. Use the subflows produced by RAVEN.  The wrong subflows are generated based on the reference traffic stats in dist.db.
```
python trace_process.py -i traces -o trace_out  -m 0 -et 1 -er 0.1 -d dist.db
```

Simulate the case that the adversary fails to include a subflow (missing error) in the reconstructed flow with a probability of 20%. Use simulated subflows and random migration frequency.

- Run the command below multiple times will produce different traces
```
python trace_process.py -i traces -o trace_out  -m 1 -et 0 -er 0.2 -f -1
```
- If rs is set, run the command below multiple times will produce the same traces
```
python trace_process.py -i traces -o trace_out  -m 1 -et 0 -er 0.2 -f -1 -rs 1000
```

Only use the first subflow for training and testing (set er to >= 1.0 to drop all the other subflows)
```
python trace_process.py -i traces -o trace_out -m 0 -et 0 -er 1.0
```

Only use the original flow for training and testing (set f to a large value to keep all subflows)
```
python trace_process.py -i traces -o trace_out -m 1 -et 0 -er 0 -f 1000000
```

#### format_convert.py 

|  option | desc  |detail|
| ------------ | ------------ | ------------ |
| i  | input  trace path   | **trace name**: siteNo_instNo <br>**trace format**: time, direction * size <br> (comma as delimiter)|
|  o | output trace path  | --  |
|  td | trace delimiter | **c (default)**: comma <br> **t**: tab <br> **s**: space  |
|  fd | trace name delimiter  | dash (-) or underscore (\_) <br> **default**: \_  | 
|  ns | if remove size  | if set, only keep direction info <br> **default**: not set  |
|  h | print help  |   --  |


Simulate the case that the adversary fails to include a subflow (missing error) in the reconstructed flow with a probability of 20%. Use simulated subflows that migration frequency is 20 outgoing packets. 

```
python trace_process.py -i traces -o trace_out  -m 1 -et 0 -er 0.2 -f 20
```

```
python trace_process.py -i traces -o trace_out  -m 0 -et 2 -er 0.1 -d dist.db
```